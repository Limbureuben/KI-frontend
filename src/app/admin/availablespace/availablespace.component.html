<div class="modern-container">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <div class="title-section">
        <h1 class="page-title">
          <mat-icon class="title-icon">landscape</mat-icon>
          Open Spaces Management
        </h1>
        <p class="page-subtitle">Monitor and manage registered open spaces</p>
      </div>

      <div class="header-stats">
        <div class="stat-item">
          <span class="stat-number">{{ dataSource.data.length }}</span>
          <span class="stat-label">Total Spaces</span>
        </div>
        <div class="stat-item">
          <span class="stat-number">{{ getActiveSpacesCount() }}</span>
          <span class="stat-label">Active</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Filter Section -->
  <mat-card class="controls-card">
    <div class="controls-header">
      <div class="controls-left">
        <h3 class="controls-title">Search & Filter</h3>
        <p class="controls-subtitle">Locate open spaces easily</p>
      </div>
    </div>

    <div class="search-controls">
      <mat-form-field appearance="outline" class="search-field">
        <mat-label>Search open spaces</mat-label>
        <input
          matInput
          (keyup)="applyFilter($event)"
          placeholder="Search by name or district">
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>

      <mat-form-field appearance="outline" class="filter-field">
        <mat-label>Status</mat-label>
        <mat-select (selectionChange)="filterByStatus($event.value)">
          <mat-option value="all">All</mat-option>
          <mat-option value="active">Active</mat-option>
          <mat-option value="inactive">Inactive</mat-option>
        </mat-select>
        <mat-icon matSuffix>filter_list</mat-icon>
      </mat-form-field>
    </div>
  </mat-card>

  <!-- Table -->
  <mat-card class="table-card">
    <div class="table-header">
      <div class="table-info">
        <h3 class="table-title">Registered Open Spaces</h3>
        <p class="table-subtitle">{{ dataSource.data.length }} spaces available</p>
      </div>

      <div class="table-actions">
        <button mat-icon-button (click)="refreshData()" title="Refresh">
          <mat-icon>refresh</mat-icon>
        </button>
      </div>
    </div>

    <div class="table-container">
      <table mat-table [dataSource]="dataSource" matSort class="modern-table">

        <!-- Open Space Name -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <mat-icon>location_on</mat-icon>
            Open Space
          </th>
          <td mat-cell *matCellDef="let space">
            <span class="primary-text">{{ space.name }}</span>
          </td>
        </ng-container>

        <!-- District -->
        <ng-container matColumnDef="district">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <mat-icon>place</mat-icon>
            District
          </th>
          <td mat-cell *matCellDef="let space">
            {{ space.district }}
          </td>
        </ng-container>

        <!-- Coordinates -->
        <ng-container matColumnDef="coordinates">
          <th mat-header-cell *matHeaderCellDef>
            <mat-icon>my_location</mat-icon>
            Coordinates
          </th>
          <td mat-cell *matCellDef="let space">
            <div class="coordinates-cell">
              <div>Lat: {{ space.latitude | number:'1.6-6' }}</div>
              <div>Lng: {{ space.longitude | number:'1.6-6' }}</div>
            </div>
          </td>
        </ng-container>

        <!-- Status -->
        <ng-container matColumnDef="isActive">
          <th mat-header-cell *matHeaderCellDef>
            <mat-icon>info</mat-icon>
            Status
          </th>
          <td mat-cell *matCellDef="let space">
            <div class="status-badge" [ngClass]="space.isActive ? 'active' : 'inactive'">
              <mat-icon>{{ space.isActive ? 'check_circle' : 'cancel' }}</mat-icon>
              {{ space.isActive ? 'Active' : 'Inactive' }}
            </div>
          </td>
        </ng-container>

        <!-- Actions -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let space">
            <button
              mat-icon-button
              [ngClass]="space.isActive ? 'deactivate' : 'activate'"
              (click)="toggleStatus(space)"
              [title]="space.isActive ? 'Deactivate' : 'Activate'">
              <mat-icon>{{ space.isActive ? 'toggle_on' : 'toggle_off' }}</mat-icon>
            </button>

            <button
              mat-icon-button
              class="delete-btn"
              (click)="deleteOpenSpaceWithConfirmation(space.id)"
              title="Delete">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>

      <!-- Empty State -->
      <div *ngIf="dataSource.data.length === 0" class="empty-state">
        <mat-icon>landscape</mat-icon>
        <h3>No Open Spaces Found</h3>
        <p>No records match your current filters.</p>
      </div>
    </div>

    <!-- Pagination -->
    <mat-paginator
      [pageSizeOptions]="[5, 10, 20]"
      [pageSize]="10"
      showFirstLastButtons>
    </mat-paginator>
  </mat-card>
</div>

